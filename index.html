<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quiz App</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div class="container-max">
    
    <header class="top-bar">
      <div class="brand">
        <h1 id="appTitle">Quiz Note</h1>
        <span class="meta" id="appMeta"></span>
      </div>
      <div id="statusBar" class="status-bar" style="display:none;">
        <span id="progressText">0 / 0</span>
        <progress id="progressBar" value="0" max="100"></progress>
      </div>
    </header>

    <section id="setupPanel" class="panel-clean">
      <div class="setup-main">
        <label>ドリルを選択</label>
        <select id="quizSelect" class="big-select">
          <option value="">読み込み中…</option>
        </select>
      </div>
      
      <details class="advanced-settings">
        <summary>URL指定・その他の設定</summary>
        <div class="panel-inner">
          <div class="field">
            <label>クイズURL直接入力</label>
            <div style="display:flex; gap:8px;">
              <input id="quizUrlInput" type="url" placeholder="https://..." style="flex:1;" />
              <button id="btnLoadUrl">読込</button>
            </div>
          </div>
          <div class="field">
             <label class="toggle">
              <input type="checkbox" id="toggleAnswers" />
              常に正解を表示（デバッグ用）
            </label>
          </div>
          <div class="field" style="margin-top:10px;">
             <button id="btnClearHistory" class="btn-danger">履歴を全削除</button>
          </div>
        </div>
      </details>
    </section>

    <section id="resultPanel" class="result-panel" style="display:none;">
      <div class="score-box">
        <span class="score-label">正答率</span>
        <span id="scoreValue" class="score-value">--%</span>
      </div>
      <div class="result-actions">
        <p id="resultMessage">おつかれさまでした！</p>
        <button id="btnRetryMissed" style="display:none;">間違えた問題だけ解く</button>
      </div>
    </section>

    <div id="app">
      <div class="placeholder-text">上のリストからドリルを選んでください。</div>
    </div>

    <div class="action-area">
      <button id="btnGrade" class="btn-primary" disabled>採点する</button>
      <button id="btnReset" class="btn-secondary">リセット</button>
    </div>

    <section class="panel-clean" style="margin-top: 40px; border-top: 2px dashed #eee; padding-top:20px;">
      <h3>学習データ</h3>
      <div class="row">
        <div class="field grow">
          <label>弱点分析・おすすめ</label>
          <div id="insights" class="small">Loading...</div>
          <div id="recommendations" class="small" style="margin-top:8px;"></div>
        </div>
        <div class="field" style="min-width: 200px;">
          <label>最近の履歴</label>
          <div id="historyList" class="small">Loading...</div>
        </div>
      </div>
      <div style="text-align:right; margin-top:8px;">
        <button id="btnRefreshInsights" class="btn-small">データを更新</button>
      </div>
    </section>

  </div>

  <script src="./study_engine.js"></script>
  <script src="./app.js"></script>
</body>
</html>
